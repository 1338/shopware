framework:
    esi: true
    form: ~
    csrf_protection: ~
    trusted_hosts: ~
    fragments: ~
    assets: ~
    session: ~
    serializer: { enabled: true }
    secret: "%env(APP_SECRET)%"
    router:
        resource: "%kernel.root_dir%/config/routing_%kernel.environment%.yml"
        strict_requirements: ~
    validation:
        enable_annotations: true
    templating:
        engines: ['twig']
    default_locale:  en
    http_method_override: true
    php_errors:
        log: true
    translator:
        fallbacks: [en_GB]
    cache:
        prefix_seed: shopware
        app: cache.adapter.filesystem

security:
    firewalls:
        login:
            pattern: ^/api/auth$
            stateless: true
            anonymous: true
            provider: api
            json_login:
                check_path: /api/auth
                success_handler: lexik_jwt_authentication.handler.authentication_success
                failure_handler: lexik_jwt_authentication.handler.authentication_failure
                require_previous_session: false

        api:
            pattern: ^/api/(?!(info|entity-schema))
            stateless: true
            provider: api
            guard:
                authenticators:
                    - lexik_jwt_authentication.jwt_token_authenticator

        storefront:
            pattern: ^(?!/api)/
            anonymous: ~
            logout_on_user_change: true
            provider: customer
            form_login:
                default_target_path: /account
                login_path: /account/login
                check_path: /account/login
                username_parameter: email
                password_parameter: password
            logout:
                path: /account/logout
                target: /

    access_control:
        - { path: ^/account/(login|login_check|logout)$, roles: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/account, roles: ROLE_CUSTOMER }
        - { path: ^/api/auth, roles: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/api/info, roles: IS_AUTHENTICATED_ANONYMOUSLY }
        - { path: ^/api, roles: IS_AUTHENTICATED_FULLY }

    providers:
        api:
            id: Shopware\Rest\Firewall\AuthProvider
        customer:
            id: Shopware\StorefrontApi\Firewall\CustomerProvider

    encoders:
        Symfony\Component\Security\Core\User\User:
            algorithm: bcrypt
            cost: 13
        Shopware\StorefrontApi\Firewall\CustomerUser:
            algorithm: bcrypt
            cost: 13

twig:
    debug:            "%kernel.debug%"
    strict_variables: false

lexik_jwt_authentication:
    private_key_path: '%kernel.root_dir%/../var/jwt/private.pem'
    public_key_path:  '%kernel.root_dir%/../var/jwt/public.pem'
    pass_phrase:      'shopware'
    token_ttl:        3600


doctrine:
    dbal:
        driver:   pdo_mysql
        host:     "%env(DATABASE_HOST)%"
        port:     "%env(DATABASE_PORT)%"
        dbname:   "%env(DATABASE_NAME)%"
        user:     "%env(DATABASE_USER)%"
        password: "%env(DATABASE_PASSWORD)%"
        charset:  "%env(DATABASE_CHARSET)%"

swiftmailer:
    transport: "%env(MAILER_TRANSPORT)%"
    host:      "%env(MAILER_HOST)%"
    username:  "%env(MAILER_USER)%"
    password:  "%env(MAILER_PASSWORD)%"
    spool:     { type: memory }

assetic:
    use_controller: false
    filters:
        cssrewrite: ~
        jsmin: ~
        lessphp:
            apply_to: '\.less$'

shopware:
    csrfProtection:
        frontend: true
        backend: true

    filesystem:
        private:
            type: "local"
            config:
                root: "%kernel.project_dir%/files"
        public:
            type: "local"
            config:
                root: "%kernel.project_dir%/web"

    cdn:
        url: ~
        strategy: "md5"

    custom: ~
    config: ~
    trustedproxies: []

    snippet:
        readFromDb: true
        writeToDb: true
        readFromIni: false
        writeToIni: false
        showSnippetPlaceholder: false

    errorHandler:
        throwOnRecoverableError: false

    elasticsearch:
        prefix: "sw_shop"
        enabled: false
        write_backlog: true
        number_of_replicas: ~
        number_of_shards: ~
        wait_for_status: "green"
        client:
            hosts: ["localhost:9200"]

    front:
        noErrorHandler: false
        throwExceptions: false
        disableOutputBuffering: false
        showException: false
        charset: "utf-8"

    store:
        apiEndpoint: "https://api.shopware.com"

    plugin_directory: "%kernel.root_dir%/../../custom/plugins"

    template:
        compileCheck: true
        compileLocking: true
        useSubDirs: true
        forceCompile: false
        useIncludePath: true
        charset: 'utf-8'
        forceCache: false
        cacheDir: "%kernel.cache_dir%/templates"
        compileDir: "%kernel.cache_dir%/templates"

    mail:
        charset: "utf-8"

    httpcache:
        enabled: true
        lookup_optimization: true
        debug: false
        default_ttl: 0
        private_headers: ["Authorization", "Cookie"]
        allow_reload: false
        allow_revalidate: false
        stale_while_revalidate: 2
        stale_if_error: false
        cache_dir: "%kernel.cache_dir%/html"
        cache_cookies: ["shop", "currency", "x-cache-context-hash"]

    session:
        cookie_lifetime: 0
        cookie_httponly: true
        gc_probability: 1
        gc_divisor: 200
        save_handler: "db"
        save_path: ~
        use_trans_sid: false
        locking: true

    phpsettings:
        error_reporting: E_ALL & ~E_USER_DEPRECATED,
        display_errors: true
        date:
            timezone: "Europe/Berlin"

    cache:
        frontendOptions:
            automatic_serialization: true
            automatic_cleaning_factor: 0
            lifetime: 3600
            cache_id_prefix: "%kernel.cache_dir%"
        backend: "auto"
        backendOptions:
            hashed_directory_perm: 0777 & ~umask()
            cache_file_perm: 0666 & ~umask()
            hashed_directory_level: 3
            cache_dir: "%kernel.cache_dir%/general"
            file_name_prefix: "shopware"

    hook:
        proxyDir: "%kernel.cache_dir%/proxies"
        proxyNamespace: "%kernel.name%"

    model:
        autoGenerateProxyClasses: false
        attributeDir: "%kernel.cache_dir%/doctrine/attributes"
        proxyDir: "%kernel.cache_dir%/doctrine/proxies"
        proxyNamespace: "%kernel.name%\Proxies"
        cacheProvider: "auto"
        cacheNamespace: ~

    backendsession:
        name: "SHOPWAREBACKEND"
        cookie_lifetime: 0
        cookie_httponly: false
        use_trans_sid: 0
        locking: false
